**

## 1 全球导航卫星系统GNSS基本介绍


全球导航卫星系统（GNSS，Global Navigation Satellite System）是一类利用卫星在全球范围内提供定位、导航与授时（PNT）服务的系统集合。它既可以指某一个具体系统（如 GPS、GLONASS、Galileo、北斗），也常被用作“多系统、多星座、多频点联合服务”的统称：用户接收机可同时接收来自不同卫星系统的信号，通过统一的观测模型进行融合解算，从而在复杂环境中获得更好的可用性与精度。GNSS不仅包括一个或多个卫星星座本体，也包括各类增强系统（例如卫星增强、地基增强、机载增强等）共同构成的综合体系。

从应用角度看，GNSS已成为国家基础设施与关键战略能力的重要组成部分：既服务交通运输、测绘、应急救灾、公众位置服务，也支撑电力、通信、金融等行业的高精度时间同步；同时，GNSS又是一种开放的公共服务体系，系统长期演进且持续升级，带来信号体制、频率资源、接口标准与兼容互操作等问题。
<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image1.jpeg" /><br>图 1 GNSS系统结构图</p>


**1. 1 GNSS定义、系统构成**

GNSS通过空间段持续播发含时间基准、星历与测距码等信息的无线电信号，用户通过测得“距离（或伪距）-几何关系”并结合时间系统来反算自身位置与时间；当引入增强系统后，还可以显著改善误差影响并提供完整性告警等能力。

GNSS主要包括三大部分：空间段（卫星星座）、地面段（运行控制与监测）、用户段（接收机与应用终端），如图1所示。空间段由导航卫星与其星座轨道构成，是信号与“参考几何”的来源；地面段包含主控站、注入站、监测站等，用于卫星测控、星历钟差估计、导航电文生成与系统健康管理；用户段则是各类终端（手持、车载、船载、机载、测量型、授时型等），通过接收信号完成PNT解算并将结果服务于上层应用。

在系统演进中，地面段与用户段的能力提升同样关键：地面段越完善，星历与钟差产品质量越高、健康管理越可靠；用户段算法与天线/射频性能越强，多系统多频点融合、抗干扰与抗多路径能力越好，最终体现为可用性、连续性与精度的整体提升。

GNSS具有战略性、公共性与动态性等特征，并天然涉及兼容与互操作，不同系统在频段、信号体制、时间与坐标框架等方面既要区分，又要尽量保证联合使用的可行性。

**1.2  GNSS定位原理和性能指标**

GNSS的基本定位思想是多边测量（trilateration），接收机测得自己到多颗卫星的距离（严格来说常为“伪距”，包含接收机钟差等误差项），并利用卫星在某一时刻的已知坐标，解算用户的三维位置与接收机钟差。由于未知量通常至少包括经纬高（或XYZ三维坐标）与接收机时钟偏差四个量，因此至少需要四颗卫星才能完成单点三维定位与授时联合解算。

伪距的获取通常基于码相关。卫星播发测距码，接收机内部生成同码型副本，通过相关峰位置得到传播时延，再乘以光速得到测距量。但因接收机钟差、电离层/对流层延迟、多路径与噪声等因素，观测值相对于真实几何距离存在偏差，因此称为“伪距”。

在高精度应用中，还可利用载波相位观测与差分/PPP等方法进一步抑制误差，但其本质仍是“观测、误差建模、几何解算”的框架。

GNSS性能评价常用一组相互关联的指标。在航空等高安全场景中，常将精度（Accuracy）、完整性（Integrity）、连续性（Continuity）、可用性（Availability）作为关键维度。精度描述定位误差大小，完整性关注系统能否在规定时间内告警“结果不可信”，连续性刻画在一次任务时间窗内不中断满足要求的概率，可用性则是满足精度、完整性与连续性要求的时间占比。

这些指标在增强系统设计中尤为重要，很多时候用户不仅需要“更准”，还需要“可证明的安全边界”和“及时告警”，这正是卫星增强系统（SBAS）与地基增强系统（GBAS）在民航等领域广泛应用的原因之一。

**1.3  导航增强星座**

SBAS这类“以地面监测网为核心、以地球同步轨道（GEO）卫星为广播链路”的增强系统，其基本工作方式是在广域范围内部署高精度参考站，实时估计GNSS主要误差（如星历钟差、电离层延迟等）并形成改正与完整性信息，再通过GEO卫星转发给用户，从而显著提升定位可靠性并提供完整性告警能力。 例如 EGNOS 被定义为欧洲区域的SBAS，用于提升GPS/Galileo等系统的性能并支持安全关键应用。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image2.jpeg" /><br>图 2 EGNOS</p>


第二类是区域导航/区域增强星座，典型代表是日本QZSS与印度IRNSS（NavIC）。这类系统通常在本区域提供更优的卫星几何与服务可用性。例如QZSS通过“准天顶”轨道设计，使至少一颗卫星在高仰角长期可见，从而在城市峡谷、山地遮挡等环境改善可用性，并可提供对GNSS的补充增强服务，IRNSS/NavIC则面向印度及周边区域提供独立PNT能力。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image3.jpeg" /><br>图 3 QZSS</p>

综合来看，导航增强星座（或增强体系）并非只是“多发几颗卫星”，而是“空间段、地面段、用户段”协同的系统工程。空间段负责广域播发改正与告警信息（或提供更优几何），地面段负责误差估计与完整性监测，用户段负责融合改正信息与自检算法。随着多系统多频点的发展，增强体系也在从单系统增强走向多系统互操作增强，从区域服务走向更广域、更高可靠的综合PNT能力。

**

## 2 现有GNSS系统介绍


**2.1 北斗**

北斗卫星导航系统是中国建设并运营的全球卫星导航系统。当前全球服务以北斗三号（BDS-3）为主体，形成“MEO为全球覆盖、IGSO/GEO强化区域服务”的混合星座思路，包括24颗MEO + 3颗IGSO + 3颗GEO，在亚太区域可提供更有利的几何条件与更高仰角可见卫星，从而增强复杂遮挡环境下的可用性与连续性。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image4.jpeg" /><br>图 4 北斗卫星</p>

从系统构成看，空间段卫星播发导航电文与测距信号；地面段通过监测网、主控与注入等设施完成星历钟差估计、健康管理与电文生成；用户段则覆盖大众消费、行业高精度与授时终端等。北斗的业务体系除基本PNT外，还逐步形成更丰富的“特色能力”组合，例如面向广域的改正/增强信息播发、部分卫星搭载的搜救（MEOSAR）等能力扩展。

北斗在“与GPS/Galileo互操作”方向上做了较强的频点对齐。例如在与GPS L1、Galileo E1同频的 1575.42 MHz 上，北斗提供B1C等开放信号；在与GPS L5、Galileo E5a同频的 1176.45 MHz 上提供B2a；同时在 1191.795 MHz（与Galileo E5 AltBOC中心频点一致）附近提供B2a/B2b相关信号设计思路，使多系统多频点接收机可以在相同射频前端下实现更高效的融合处理。常见公开频点/信号可概括为：B1I（1561.098 MHz）、B1C（1575.42 MHz）、B2a（1176.45 MHz）、B2b（1207.14 MHz）、B3I（1268.52 MHz）等。

北斗可与其他GNSS的联合使用，主要价值在于多星座提升可见卫星数与几何强度（DOP改善），直接提高城市峡谷、林区、山地等环境的可用性；其二，多频点为电离层延迟削弱提供更稳健手段（双频/三频观测），利于高精度定位（RTK、PPP等）；其三，频谱与体制层面的互操作性增强，使接收机能够更统一地处理不同系统信号，降低复杂度并提升抗干扰与抗多路径能力。

**2.2 GPS**

GPS是最早实现全球业务化运行并长期主导民用产业生态的GNSS，从早期Block卫星到后续现代化批次的连续演进是在保持对既有民用信号后向兼容的前提下，通过增加新民用信号（如L2C、L5、L1C）、增强军用抗干扰能力（如M码）以及提升星载原子钟与导航电文质量，来持续改善精度、完整性与抗干扰性能。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image5.jpeg" /><br>图 5 GPS卫星</p>

在空间段构型上，GPS经典设计目标是全球任意地点同时可见4颗以上卫星，满足单点三维定位与授时解算需求。其星座通常描述为中圆轨道（MEO）多轨道面布置，24星、6轨道面、约55°倾角，这种结构在全球覆盖与地面控制可实施性之间取得了长期稳定的平衡。GPS地面段由主控、监测与注入等设施构成，核心任务是卫星测控、轨道确定与钟差估计、导航电文生成发布，以及对卫星健康状态的监测与告警。

GPS以扩频体制为核心，利用码分多址（CDMA）在同频共享的方式区分不同卫星，并通过载波调制承载测距码与导航电文。经典频点为L1（1575.42 MHz）与L2（1227.60 MHz），现代化新增L5（1176.45 MHz，面向安全关键/高可靠应用的“安全生命”频段特性更突出）。围绕这些载波，GPS形成了民用C/A码、军用P(Y)码、现代化L2C/L1C以及军用M码等多层信号组合，从而兼顾开放服务、专业测量与高抗干扰需求。

GPS长期产业化的核心原因在于开放服务信号稳定、全球覆盖成熟、接口规范与接收机生态完善。进入多系统时代后，GPS更多体现为“基准系统”之一，信号频点与Galileo/北斗的对齐，使得多星座融合成为主流接收机的默认能力；而L5等新信号的引入，也为多频精密定位与复杂环境增强提供了更好的观测条件。

**2.3 GLONASS**

GLONASS是俄罗斯建设并运营的全球卫星导航系统。在星座构型上，GLONASS同样采用MEO星座实现全球覆盖，24星、3轨道面、较高轨道倾角（常见为约64.8°），以更好覆盖高纬度地区。地面段的任务与其他GNSS类似，重点在于轨道与钟差确定、导航电文生成与注入、系统运行维护与完好性管理。用户段覆盖民用开放服务与授权服务接收机，并在与其他GNSS联合使用中显著改善可用性（尤其在高纬/遮挡环境中）。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image6.png" /><br>图 6 GLONASS卫星</p>

GLONASS经典民用信号主要分布在G1（约1.6 GHz）与G2（约1.25 GHz）频段，并通过频分多址（FDMA）为不同卫星分配不同频点（即同一信号体制、不同载波频率）。这一做法的直接结果是接收机射频前端与滤波设计要覆盖更宽的频率范围，且多系统共存时更需精细处理频谱邻近干扰与互调问题。

随着多GNSS互操作需求增强，GLONASS近年来的重要方向是在保留FDMA体系的同时，引入CDMA开放信号与新频点（如L3相关信号），以便在接收机端更容易与GPS/Galileo/北斗进行统一相关处理，降低多系统融合的工程复杂度，并改善频谱兼容性。

**2.4 GALILEO**

Galileo是欧盟/欧洲航天局主导建设的全球卫星导航系统，其设计从一开始就更强调“民用主导、服务分层清晰、与其他GNSS互操作”的理念。Galileo同样采用MEO星座实现全球覆盖，“3轨道面、每面若干卫星并含备份星”的规划，以保证全球任意地点的多星可见与良好的几何强度。地面段由控制中心与全球监测站网构成，承担轨道/钟差确定、导航电文生成、健康监测与服务性能评估等任务。用户段面向开放服务（OS）及更高等级业务（如商业/授权服务等）提供差异化能力，尤其适合多频组合与宽带观测驱动的高精度定位场景。

<p align="center"><img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image7.jpeg" />图 7 GALILEO星座</p>



在频率与信号计划上，Galileo的互操作性非常突出，其E1频点与GPS L1、北斗B1C同频（1575.42 MHz），E5a与GPS L5/北斗B2a同频（1176.45 MHz），E5b与北斗B2I/B2b存在频段对齐（1207.14 MHz），同时还提供E6（1278.75 MHz）等业务频点；并且E5采用较宽带的信号设计（E5a/E5b及其组合），为抗多路径、提高测距精度与多频电离层改正提供更优观测条件。



## 3. GNSS导航定位原理


卫星导航定位是把“卫星发射信号、信号传播、接收机测量”转化为可解算的几何与时间问题。对用户而言，接收机能做的事情很朴素，接收来自多颗卫星的无线电信号，测出信号传播所用的时间（或相位差），再乘以光速得到“距离观测”；把这些距离观测与卫星在空间中的已知位置联系起来，最终反算出用户的三维坐标与本机时钟偏差。北斗信号从结构上可理解为“载波 + 测距码（伪码）+ 导航电文（数据码）”，测距码先对数据码扩频，再调制到载波上播发，接收机据此实现测距与解算。

**3.1  测距定位原理**

**3.1.1 伪距测量**

“伪距”是最常用、最直接的测距量。卫星端按统一的系统时间标记信号发射时刻，接收机端在本机时钟下记录信号到达时刻；二者之差乘以光速，就得到一条“距离观测”。之所以叫“伪距”，是因为这条距离里混入了接收机钟差、卫星钟差、星历误差、硬件延迟以及电离层/对流层传播延迟等项，因而不等于纯几何距离。

伪距主要通过“码相关”获得：接收机生成与卫星测距码一致的本地码，与来波做相关，相关峰位置对应码相位差，从而得到传播时延。由于测距码的“刻度”是已知的，伪距测量可直接得到距离，但其精度受码率、带宽、信噪比、多路径等影响，通常为米级到分米级（随条件变化）。

**3.1.2 载波相位测量**

除伪距外，接收机还可测“载波相位”。直观地说，载波相位相当于用更短的“尺子刻度”去量距离。载波波长只有几十厘米量级，因此相位观测噪声可达到毫米级（例如B1载波波长约19 cm，对应观测误差可到毫米量级），精度显著优于码伪距。

但载波相位只能观测到“当前处在某一载波周期内的相对相位”，而无法直接知道从卫星到接收机跨了多少个完整波长，于是引入未知的整周模糊度参数。伪距不存在整周模糊度问题，而载波相位必须通过初始化、组合观测、差分或滤波等方式把模糊度解出来，才能把“高精度相位”真正转化为“高精度距离”。

**3.1.3 基本观测方程**

无论是伪距还是载波相位，最终都要落到统一的观测模型上。观测值 = 几何距离 + 时间相关项 + 大气延迟 + 硬件延迟 + 噪声/多路径等。以单站观测某颗卫星为例，模型通常包含：几何距离ρ、接收机钟差与卫星钟差、对流层延迟、电离层延迟、以及接收机/卫星端的伪距硬件延迟或相位硬件延迟；载波相位还额外包含整周模糊度N与相位测量噪声项。

这类方程把“误差”从不可控的黑箱，变成可估计、可建模、可差分削弱的对象。后续所有定位算法（单点、差分、PPP等），本质都是围绕这些项做取舍。哪些可以用模型改正，哪些作为未知参数联同位置一起估计，哪些通过求差抵消公共误差，哪些只能依靠天线/环境/信号处理去抑制。

**3.1.4 解算机制**

在最经典的单点伪距定位中，未知量至少包括三维坐标（X、Y、Z）与接收机钟差四个，因此需要四颗及以上卫星建立方程组进行求解。由于观测方程对位置是非线性的，工程上通常采用线性化 + 迭代最小二乘（或卡尔曼滤波）来逐步修正位置与钟差，直到收敛。

当卫星数超过4颗时，方程组变为超定系统，最小二乘可在噪声意义下给出更稳健的估计；同时可以引入权阵（与卫星高度角、信噪比等相关）让“更可靠的观测”在解算中占更大权重，从而降低多路径与低仰角大气误差对结果的污染。几何分布越好，测距误差向位置误差的放大越小，这就引出了DOP精度因子的概念。

**3.2 定位精度及误差分析**

**3.2.1 测距误差与几何因子**

定位精度可以粗略理解为等效测距误差 × 几何放大倍数（DOP），DOP反映卫星与用户几何构型对误差传播的影响。在测距精度相同的条件下，卫星视线方向越分散、空间几何越“立体”，定位误差越小；若卫星集中在同一侧或仰角普遍偏低，误差将被明显放大。

DOP常用指标包括GDOP、PDOP、HDOP、VDOP、TDOP等。对于地面用户，由于卫星只能出现在地平线以上的半球，垂直方向的几何约束天然弱于水平方向，因此常见现象是VDOP普遍大于HDOP（例如某站点统计中HDOP约0.6–1.0、VDOP约0.8–1.6，且VDOP/HDOP大于1），这也是为什么同等条件下高程精度通常不如平面精度。

**3.2.2 误差源**

从机理上，影响定位精度的误差通常可分为三大类：

1）与卫星有关：卫星星历误差、卫星钟差误差等；

2）与传播有关：电离层延迟、对流层延迟、多路径效应等；

3）与接收机/测站有关：接收机钟差、天线相位中心偏移、测量噪声等。

进一步按性质又可分为系统误差与随机误差：星历、钟差与大气折射往往具有较强的系统性（可建模/可估计/可差分削弱）；多路径与接收机热噪声更偏随机，难以建立精确模型，只能通过信号处理、选址与天线工程等减弱其影响。

**3.2.3 典型等效测距误差量级**

在单频接收机、完成常规模型改正后，各类误差源仍会表现为一定量级的“等效测距误差”。一组典型的1σ量级可概括为：卫星钟差约2 m、星历误差约1 m、电离层延迟可达约5 m、对流层延迟约1 m、多路径约1.2 m、测量噪声约1 m（具体随环境与设备变化）。电离层项在单频场景往往最大，也是造成单点定位误差波动的重要来源之一。

电离层本质上是一个含大量自由电子的弥散介质，对1 GHz以上的导航信号主要产生折射效应，使码与载波的传播速度发生改变、路径弯曲，从而引入米级甚至更大的延迟误差；其影响与太阳活动、时间、地理位置、卫星仰角密切相关，并且呈现明显的频率相关性，这也是双频/多频组合能有效削弱电离层误差的物理基础。

**3.2.4 卫星端误差**

卫星星历与钟差由地面运控系统基于监测数据估计并预报得到，因此不可避免包含估计与预报误差；若用户直接使用广播星历与钟差，定位结果会相应产生偏差。工程上常用“用户测距误差”类指标去表征这部分影响，并可进一步转化为定位误差预算的一部分。

针对北斗公开服务性能，常用SISRE（空间信号测距误差）来表征与卫星端相关的测距误差成分，其通常包含卫星钟差、星历与群时延等项（不含单频电离层、传输与用户端误差）。在一组公开指标中，北斗三号B1I/B3I信号SISRE可做到不大于1.0 m，B1C/B2a信号SISRE可做到不大于0.6 m量级，体现了现代化信号与运控能力提升对用户测距质量的支撑。

**3.2.5 传播误差**

传播误差里最“顽固”的通常是电离层与多路径。电离层虽大，但可利用双频无电离层组合、区域/全球电离层模型或增强改正来显著削弱；对流层延迟一般更平滑，可用经验模型、气象数据或估计天顶延迟参数来降低残差；多路径则与环境强相关——建筑物、水面反射会让信号在到达天线前出现多径叠加，导致相关峰偏移或相位扰动，难以靠简单模型完全消除，更多依赖天线抑制、选址、遮挡控制与接收机跟踪环设计。

这也解释了为何同样是“米级测距噪声”，在空旷环境与城市峡谷环境中，定位表现可能差别巨大。城市环境不仅多路径更强、遮挡更严重，还会导致可见卫星数下降、几何变差（DOP升高），从而形成“测距误差变大 + 几何放大更强”的叠加效应。

**3.2.6 误差抑制**

针对系统误差，工程上常见的处理思路可归纳为四类：

1）把误差当未知参数：例如把接收机钟差、对流层延迟参数并入状态量，与位置一并估计；

2）建立误差模型改正：如电离层模型、对流层模型、相对论改正、天线相位中心改正等；

3）对同步观测求差：通过单差/双差等方式削弱公共误差项；

4）在可接受条件下忽略：对影响很小或难以建模的项做工程近似处理。

随机误差（多路径、噪声）则主要靠抑制与平均化手段，而非精确建模。

**3.2.7 定位思路**

差分定位利用“基准站与流动站对同一批卫星的观测误差高度相关”这一事实，基准站坐标已知，可把自身观测中的误差估计为改正数并广播给流动站；流动站应用改正后，卫星钟差可基本消除，星历与大气误差也能大幅削弱（但随基线变长相关性下降），而多路径与接收机噪声因不具公共性而难以被差分消除。

在相同条件下，单点定位的误差预算中卫星钟差约2 m、星历约2 m、电离层约1–5 m、对流层约1 m；差分后卫星钟差可近似为0，星历可降到约0.1 m量级，大气残差可降到约0.2 m量级，但多路径与测量噪声基本不变；若取DOP≈2，单点定位误差可达10–15 m量级，而差分可到1–5 m量级（随环境、基线与实现方式变化）。同时，差分精度会随基准站距离增大而劣化，例如短基线可达亚米级，而基线扩展到更大尺度时精度下降明显。

当引入载波相位观测，并配合更高质量的星历与钟差产品（精密轨道、精密钟差），单台接收机也可以实现厘米级乃至更高精度的定位，这类方法的关键在于把伪距与相位观测统一建模，精细处理硬件延迟与大气残差，并在滤波收敛后可靠固定或吸收模糊度参数，从而把相位的毫米级观测能力转化为位置域的厘米级结果。


## 4. 导航卫星动力学模型


导航定位是在解几何方程，而几何方程的输入来自卫星位置与卫星钟差。卫星位置并不是在空间中被直接测得，而是通过轨道动力学模型与星历参数描述出来，再由用户在观测历元把卫星坐标计算出来。动力学模型的任务可以理解为两层含义，一层是用尽可能简洁的规律描述卫星绕地运动的主导结构，另一层是在主导结构之上把不可避免的摄动作用以合适的方式吸收进参数或改正项，让计算出的轨道在若干小时乃至更长时间内保持足够精度。理解这一点有助于把无摄运动与受摄运动统一起来，也有助于把星历参数看成对轨道动力学的工程化编码。

<img src="https://raw.githubusercontent.com/amariszhou/desksat/main/1_stackedit_pandoc_pkg/media/image8.png" />
<p align="center">图 8 轨道动力学示意图</p>


**4.1  无摄运动**

无摄运动常被称为二体问题或两体问题，它把卫星视作在地球中心引力作用下运动，忽略地球非球形、太阳月球引力、太阳光压等其他影响。在这种理想化假设下，轨道是稳定的开普勒轨道，其核心结论可以归结为轨道是以地球为焦点的圆锥曲线。对于导航卫星最常见的是椭圆轨道，速度随位置变化以及周期与轨道尺度之间存在明确的幂律关系，如式1-3。

$$
\ddot{\mathbf r}=-\frac{\mu}{r^{3}}\mathbf r \tag{1}
$$

$$
v^{2}=\mu\left(\frac{2}{r}-\frac{1}{a}\right) \tag{2}
$$

$$
n=\sqrt{\frac{\mu}{a^{3}}},\quad
T=\frac{2\pi}{n}=2\pi\sqrt{\frac{a^{3}}{\mu}} \tag{3}
$$

常用轨道根数来参数化一条椭圆轨道，椭圆的形状大小由长半轴与偏心率决定，近地点地心距与远地点地心距可直接由长半轴与偏心率给出，因而这两者被称为形状参数。轨道在三维空间的朝向由轨道倾角，升交点赤经或升交点经度，以及近地点角距确定，它们共同决定轨道平面与赤道平面的空间关系以及椭圆在轨道平面内的定向，因而常被称为定向参数。

描述卫星在椭圆上的瞬时位置时，既可以用真近点角，也可以用偏近点角和平近点角。真近点角是从近地点起算的几何角度，直接对应卫星在轨道上的位置，而偏近点角与平近点角则更便于建立时间关系。平近点角可以看成把椭圆运动等效为均匀圆周运动后得到的相位，它与时间呈线性关系。平均运动角速率与轨道周期相关，而周期与长半轴满足开普勒第三定律的表达式，因而一旦轨道尺度确定平近点角随时间的变化就能被稳定刻画。

$$
M = E - e\sin E \tag{4}
$$

$$
E_{k+1} = M + e\sin E_k \tag{5}
$$

$$
\tan\frac{\nu}{2}=\sqrt{\frac{1+e}{1-e}}\tan\frac{E}{2} \tag{6}
$$

从平近点角回到真实椭圆上的位置需要经过偏近点角这一中间变量，二者之间满足开普勒方程，这是一个超越方程，通常用迭代法求解。先以平近点角作为初值再用固定点迭代逐步逼近，当相邻两次迭代差小于预设阈值时停止。得到偏近点角后，可以进一步计算真近点角。真近点角与偏近点角之间的关系可以用半角公式写成反正切形式，这样能自动处理象限问题并且在数值实现中更稳健。平近点角与偏近点角、真近点角的关系式与迭代求解方法如式4-5所示。

轨道六根数在二体假设下大多可视为常量，除了用于表征位置的近点角随时间推进。星历系统往往把开普勒参数作为主体，把其他复杂效应作为改正项叠加在主体之上，这使得用户端可以在不进行复杂动力学积分的情况下仅用少量参数快速计算卫星位置。轨道平面内的位置表达如式7-8所示。

$$
p=a(1-e^{2}),\quad r=\frac{p}{1+e\cos\nu} \tag{7}
$$

$$
x' = r\cos\nu,\quad y' = r\sin\nu \tag{8}
$$

**4.2  受摄运动**

真实的导航卫星并不满足二体假设，除地球中心引力外还会受到多种摄动力的影响。这些摄动力让原本应保持常量的开普勒根数变为时间的函数，从而在长期长周期或短周期尺度上发生变化。对中圆轨道及更高轨道高度的导航卫星而言，大气阻力一般可以忽略，主要需要关注的摄动力往往包括地球非球形引力项，日月引力摄动、太阳光压以及潮汐等效应。

$$
\ddot{\mathbf r}=-\frac{\mu}{r^{3}}\mathbf r+\mathbf a_{\mathrm{pert}} \tag{9}
$$

$$
\mathbf a_{\mathrm{pert}}=\mathbf a_{J2}+\mathbf a_{3\mathrm{rd}}+\mathbf a_{\mathrm{SRP}}+\cdots \tag{10}
$$

$$
U_{J2}=\frac{\mu}{r}J_{2}\left(\frac{R_e}{r}\right)^{2}\frac{1}{2}\left(3\sin^{2}\varphi-1\right) \tag{11}
$$

$$
\mathbf a_{J2}=-\nabla U_{J2} \tag{12}
$$

$$
\dot{\Omega}=-\frac{3}{2}J_{2}n\left(\frac{R_e}{p}\right)^{2}\cos i \tag{13}
$$

$$
\dot{\omega}=\frac{3}{4}J_{2}n\left(\frac{R_e}{p}\right)^{2}\left(5\cos^{2}i-1\right) \tag{14}
$$


受摄运动的动力学表达式如式9-10所示，地球非球形J2引力势与加速度如式11-12所示，长期进动率如式13-14所示。

在量级上，地球中心体引力的加速度远大于其他项，但其他项虽然小却会在时间积累下造成显著的轨道偏移。例如地球中心体引力加速度约为 0.56 m/s<sup>2</sup>，地球扁率相关的 J2 摄动量级约为 5.5\*10<sup>-4</sup> m/s<sup>2</sup>，日月引力量级约为 6.5\*10<sup>-5</sup> m/s<sup>2</sup>，太阳光压量级约为 7\*10<sup>-7</sup> m/s<sup>2</sup>。在这样的摄动背景下若只用简单二体模型外推，数小时到数日内的轨道偏差会快速放大，三小时内可达公里级，两天内可达十余公里级，这显然难以满足米级乃至更高的导航定位需求，因而必须引入摄动力建模或在星历参数中显式吸收其影响。

地球非球形摄动中，J2 项来源于地球扁率导致的引力位偏离球对称，会使轨道平面发生缓慢进动，具体表现为升交点的长期漂移和近地点角距的缓慢变化，同时对平近点角的变化率产生影响。对近地点角距而言存在一个著名的临界倾角现象，当倾角约为 63.4 度时，近地点角距的长期漂移近似为零，近地点在轨道平面内近似不动，这在某些轨道设计中具有重要意义。平近点角的长期项也会受到J2摄动影响，对中圆轨道卫星而言，平均运动的改正量可以达到每天百分之一度量级，这类长期项会在星历与用户算法中被单独处理。

$$
\mathbf a_{3\mathrm{rd}}
=\mu_{3}\left(
\frac{\mathbf r_{3}-\mathbf r}{\left\|\mathbf r_{3}-\mathbf r\right\|^{3}}
-\frac{\mathbf r_{3}}{\left\|\mathbf r_{3}\right\|^{3}}
\right)\tag{15}
$$

日月引力摄动可以从多体问题的角度理解，卫星在围绕地球运动时同时受到太阳与月球引力的扰动，造成长周期轨道摄动。由于太阳和月球相对卫星距离很远，在一般精度需求下 只需把它们作为外部摄动体建立引力摄动模型即可，这类模型常基于牛顿第二定律与万有引力定律构建，三体引力摄动加速度如式15所示。

$$
\mathbf a_{\mathrm{SRP}}
= P_{0}\frac{A}{m}C_{R}\left(\frac{\mathrm{AU}}{r_{s}}\right)^{2}\hat{\mathbf s}\tag{16}
$$

太阳光压量级通常比日月引力更小，但它属于耗散性非保守力，容易造成轨道的长期漂移，并且与卫星表面形状、材质、姿态以及日月位置等因素有关，呈现明显的时变性。因此在轨道估计中，往往需要把太阳光压作为重点建模因素，甚至引入待估参数来吸收模型不完善带来的残差。太阳光压加速度监话模型如式16所示。

受摄运动的处理路径大体有两条，第一条是在地面或系统侧做精密定轨，用高保真动力学模型对摄动进行数值积分，并输出更精密的轨道产品；第二条是在广播星历层面做参数化，把最显著的长期项与短周期项用少量改正参数表示，让用户端能够快速重建足够准确的卫星位置。

**4.3 星历定位**

星历定位可以理解为利用导航电文提供的星历参数，在观测历元计算卫星在地心地固坐标系中的位置，然后把该位置作为定位方程的已知量结合伪距或载波观测解算用户的位置与钟差。星历是对轨道运动的一组参数化描述，用户端不必进行长时间积分，只需按规定算法完成若干步代数运算与一次开普勒方程迭代就能得到卫星坐标。

广播星历的基本形态通常包含参考历元下的开普勒轨道根数以及用于补偿摄动效应的改正项参数。由于轨道根数在摄动力作用下会发生长期长周期与短周期变化，因而需要扩展六根数并加入相应改正项以便更准确地计算卫星位置。

一类典型的参数构成是由六个开普勒根数为主体再加上线性漂移项与若干二倍角的周期调和项以及星历参考时间。以常见配置为例，星历由描述轨道特征的参数加上参考时间组成并以小时级频率更新。

在系统演进中广播星历会在参数化方式上做优化以更好吸收摄动的长期项并提高外推稳定性。例如较新的星历形式会把长半轴从直接给出改为给出相对参考值的偏差，并增加长半轴变化率、平均运动改正量及其变化率等长期项以用来吸收由更高阶摄动造成的慢变效应，同时保留对纬度幅角、地心距、与轨道倾角的正余弦调和改正项以补偿主要短周期扰动。

把星历参数转化为卫星位置的计算过程本质上是把无摄开普勒轨道的计算链条与摄动改正链条拼接在一起。典型流程可以用叙述方式概括如下，首先以观测时刻减去星历参考时刻得到时间差，然后由长半轴得到平均运动角速率并结合平均运动改正量得到修正后的平均运动，进而计算观测历元的平近点角。接下来通过迭代求解开普勒方程得到偏近点角再由偏近点角计算真近点角最终得到纬度幅角。

在这一主链条上再叠加三类调和改正，一类修正纬度幅角，一类修正地心距，一类修正轨道倾角，这些改正往往以二倍纬度幅角的正余弦形式出现，反映了主要摄动在轨道周期上的短周期特征。

得到轨道平面内的位置后需要把它旋转到地心地固坐标系。旋转过程通常涉及近地点角距与升交点相关参数以及地球自转的影响。升交点相关参数本身会随时间缓慢变化，其变化不仅由 J2 引起，因而不能被视作严格常数。星历中往往给出其变化率并在计算时进行时间推进。此外在把卫星位置用于伪距方程时还需考虑信号传播时间内地球自转引起的坐标旋转效应，这是由于在几十毫秒传播时间内，地球自转即可带来可观的水平位置偏差，若不处理会直接映射到测距残差上。

从定位解算角度看星历定位把问题拆成两步。第一步对每颗可见卫星用星历算法计算出卫星在观测历元的空间位置。第二步把卫星位置代入测距观测方程形成关于用户三维坐标与接收机钟差的非线性方程组，用四颗及以上卫星即可求解，若卫星更多则可用最小二乘或滤波获得更稳健的估计。星历误差与钟差误差会以等效测距误差的形式进入观测方程，因而星历更新频率与星历外推质量会直接影响定位精度，这也是广播星历要持续更新并不断改进参数化方式的重要原因。

需要强调的是，星历定位并不要求用户理解全部动力学细节，但理解动力学模型的分层结构会显著提升对算法行为的解释力。无摄运动提供可解析且数值稳定的主结构，受摄运动解释为何轨道根数会漂移以及为何必须引入长期项与短周期项，星历定位则把这些物理与工程折中凝结为一套可由接收机实时执行的计算链条。从系统工程视角看星历的设计是一种把复杂动力学压缩成有限参数的艺术，既要让参数数量可控又要让它在小时级外推内足以吸收主要摄动力的影响，这正是现代导航系统持续演进的重要方向。
<!--stackedit_data:
eyJoaXN0b3J5IjpbOTY0OTEwMjk4LDE3MTY3ODI5MjcsLTUyND
AyNDY3NiwyMTMwMTk0NTI4LDE2ODI5ODQ2NzZdfQ==
-->